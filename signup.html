<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signup</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .bg-video {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.55);
            z-index: -1;
        }

        form {
            background: rgba(255, 255, 255, 0.97);
            width: 650px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px 35px;
            border-radius: 16px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.45);
        }

        h2 {
            text-align: center;
            margin-bottom: 25px;
        }

        h4 {
            margin-bottom: 6px;
        }

        input,
        textarea {
            width: 100%;
            padding: 11px 14px;
            margin-bottom: 14px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        #Personal_Details,
        #Password,
        #Parents_Father,
        #Parents_Mother {
            display: flex;
            gap: 10px;
        }

        .text {
            width: 32%;
        }

        #Gender input {
            width: auto;
            margin-right: 6px;
        }

        .Parent_Details {
            font-weight: bold;
            margin-top: 15px;
        }

        .checkbox-section {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .checkbox-section label {
            font-size: 13px;
            color: #333;
            height: 14px;
        }

        .checkbox-section input[type="checkbox"] {
            width: auto;
            margin-right: 6px;
        }

        .cheackbox-item label {
            display: inline-block;
            gap: 20px;
        }

        #Submit_Form {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 20px;
        }

        button {
            padding: 12px 32px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .doc-box {
            background: #f4f6ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .checkbox-section {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .checkbox-item {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        @media (max-width: 650px) {

            #Personal_Details,
            #Password,
            #Parents_Father,
            #Parents_Mother {
                flex-direction: column;
            }

            .text {
                width: 100%;
            }
        }

        #step3 h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 22px;
            color: #1f2937;
        }

        /* Main academic card */
        #step3 .academic-section {
            background: #f4f6ff;
            padding: 24px;
            border-radius: 14px;
            border: 1px solid #dbe0ff;
        }

        /* Section headings */
        #step3 h3 {
            margin: 22px 0 12px;
            font-size: 16px;
            font-weight: bold;
            color: #4f46e5;
            border-left: 4px solid #4f46e5;
            padding-left: 10px;
        }

        /* Inputs & selects */
        #step3 input,
        #step3 select {
            width: 100%;
            padding: 12px 14px;
            margin-bottom: 14px;
            border-radius: 8px;
            border: 1px solid #c7c9ff;
            font-size: 14px;
            background: #fff;
            transition: all 0.25s ease;
        }

        /* Focus effect */
        #step3 input:focus,
        #step3 select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.25);
        }

        /* File upload inputs */
        #step3 input[type="file"] {
            padding: 10px;
            background: #eef1ff;
            border: 2px dashed #a5b4fc;
            cursor: pointer;
        }

        /* Divider line */
        #step3 .section-divider {
            margin: 22px 0;
            height: 1px;
            background: linear-gradient(to right, transparent, #c7c9ff, transparent);
        }

        /* Buttons area */
        #step3 #Submit_Form {
            display: flex;
            justify-content: center;
            gap: 14px;
            margin-top: 25px;
        }

        /* Buttons */
        #step3 #Submit_Form button {
            padding: 12px 34px;
            border-radius: 10px;
            border: none;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        /* Hover */
        #step3 #Submit_Form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 28px rgba(102, 126, 234, 0.4);
        }

        /* Back button */
        #step3 #Submit_Form button:first-child {
            background: linear-gradient(135deg, #9ca3af, #6b7280);
        }

        /* ===============================
   RESPONSIVE (MOBILE)
================================ */
        @media (min-width: 700px) {
            #step3 .academic-section {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 16px 18px;
            }

            #step3 h3,
            #step3 .section-divider {
                grid-column: span 2;
            }
        }

        @media (max-width: 699px) {
            #step3 .academic-section {
                display: block;
            }
        }
    </style>
</head>

<body>

    <video class="bg-video" autoplay muted loop>
        <source src="Login_Images/VID-20260211-WA0000.mp4" type="video/mp4">
    </video>

    <form onsubmit="event.preventDefault()">

        <!-- STEP 1 -->
        <div id="step1">
            <h2>Create Account</h2>

            <div id="Personal_Details">
                <input class="text" id="fname" placeholder="First Name" required>
                <input class="text" id="mname" placeholder="Middle Name" required>
                <input class="text" id="lname" placeholder="Last Name" required>
            </div>

            <div id="Password">
                <input type="password" id="password" placeholder="Password" required>
                <input type="password" id="confirm_password" placeholder="Confirm Password" required>
            </div>

            <input type="email" id="email" placeholder="Email" required>

            <div id="Gender">
                <h4>Gender</h4>
                <input type="radio" name="gender" value="Male" required> Male
                <input type="radio" name="gender" value="Female" required> Female
                <input type="radio" name="gender" value="Other" required> Other
            </div>

            <input type="tel" id="phone" placeholder="Phone Number" required>
            <input type="date" id="dob" required>
            <textarea id="address" placeholder="Address" required></textarea>

            <h4 class="Parent_Details">Father Details</h4>
            <div id="Parents_Father">
                <input id="father_name" placeholder="Father Name" required>
                <input id="father_phone" placeholder="Father Phone" required>
            </div>

            <h4 class="Parent_Details">Mother Details</h4>
            <div id="Parents_Mother">
                <input id="mother_name" placeholder="Mother Name" required>
                <input id="mother_phone" placeholder="Mother Phone" required>
            </div>

            <div id="Submit_Form">
                <button type="button" onclick="nextStep()">Next →</button>
            </div>

            <p style="text-align:center; font-size: 12px; margin-top: 12px;"><a href="login.html"
                    style="text-decoration: none; color: #667eea">Already have an account? Login here</a></p>
        </div>

        <!-- STEP 2 -->
        <div id="step2" style="display:none;">
            <h2>Identity Verification</h2>

            <div class="doc-box">
                <input id="nationality" placeholder="Nationality" required>

                <label>Citizenship (PDF)</label>
                <input type="file" id="citizenship" accept=".pdf" required>

                <label>Passport (PDF)</label>
                <input type="file" id="passport" accept=".pdf" required>

                <label>Election Card (Optional)</label>
                <input type="file" id="election" accept=".pdf">

                <label>National ID (Optional)</label>
                <input type="file" id="id_card" accept=".pdf">
            </div>

            <div class="checkbox-section">
                <div class="checkbox-item">
                    <div>
                        <input type="checkbox" required>
                        <label>I confirm all documents are valid</label>
                    </div>
                    <div>
                        <input type="checkbox" required>
                        <label>I agree to the terms and conditions</label>
                    </div>
                </div>
            </div>

            <div id="Submit_Form">
                <button type="button" onclick="prevStep()">← Back</button>
                <button type="button" onclick="nextStep()">Next →</button>
            </div>
            <p style="text-align:center; font-size: 12px; margin-top: 12px;"><a href="login.html"
                    style="text-decoration: none; color: #667eea">Already have an account? Login here</a></p>
        </div>

        <!-- STEP 3 -->
        <div id="step3" class="form-step academic-step" style="display:none;">
            <h2>Academic Details Form</h2>

            <div class="doc-box academic-section">

                <!-- 10th -->
                <h3>10<sup>th</sup> Standard Details</h3>

                <label>School Name</label>
                <input type="text" id="school10" class="academic-input" placeholder="Enter school name" required>

                <label>Board Name</label>
                <input type="text" id="board10" class="academic-input" placeholder="CBSE / ICSE / State Board" required>

                <label>Year of Passing</label>
                <input type="number" id="year10" class="academic-input" placeholder="YYYY" required>

                <label>Percentage / CGPA</label>
                <input type="text" id="cgpa10" class="academic-input" placeholder="e.g. 89% or 9.1" required>

                <div class="section-divider"></div>

                <!-- 12th -->
                <h3>12<sup>th</sup> Standard Details</h3>

                <label>School / College Name</label>
                <input type="text" id="school12" class="academic-input" placeholder="Enter college name" required>

                <label>Board / University</label>
                <input type="text" id="board12" class="academic-input" placeholder="HSC / CBSE / University" required>

                <label>Year of Passing</label>
                <input type="number" id="year12" class="academic-input" placeholder="YYYY" required>

                <label>Percentage / CGPA</label>
                <input type="text" id="cgpa12" class="academic-input" placeholder="e.g. 85% or 8.5" required>

                <div class="section-divider"></div>

                <!-- Course -->
                <h3>Current Course Details</h3>

                <label>Course Name</label>
                <select id="course" class="academic-input" required>
                    <option value="">Select your course</option>
                    <option>Computer Engineering</option>
                    <option>Information Technology</option>
                    <option>Electronics and Telecommunication</option>
                    <option>Mechanical Engineering</option>
                    <option>Civil Engineering</option>
                    <option>CSE AI/ML</option>
                    <option>Electrical Engineering</option>
                    <option>B.Voc (IOT)</option>
                </select>

                <label>PRN (Permanent Registration Number)</label>
                <input type="text" id="prn" class="academic-input" placeholder="Enter PRN" required>

                <label>Graduation Year</label>
                <input type="number" id="grad_year" class="academic-input" placeholder="YYYY" required>

                <div class="section-divider"></div>

                <!-- DOCUMENTS -->
                <h3>Document Uploads</h3>

                <label>Passport Size Photo</label>
                <input type="file" id="passport_photo" accept="image/*" required>

                <label>10<sup>th</sup> Marksheet (PDF)</label>
                <input type="file" id="marksheet10" accept="application/pdf" required>

                <label>12<sup>th</sup> Marksheet (PDF)</label>
                <input type="file" id="marksheet12" accept="application/pdf" required>

                <label>Transcript (Optional)</label>
                <input type="file" id="transcript" accept="application/pdf">

                <label>Migration Certificate (Optional)</label>
                <input type="file" id="migratory_cert" accept="application/pdf">
            </div>

            <div id="Submit_Form">
                <button type="button" onclick="prevStep()">← Back</button>
                <button type="button" onclick="finalSubmit()">Submit ✓</button>
            </div>
        </div>
    </form>

    <script>
        let currentStep = 1;

        /* =========================
           CACHE ELEMENTS (IMPORTANT)
        ========================= */
        const step1 = document.getElementById("step1");
        const step2 = document.getElementById("step2");
        const step3 = document.getElementById("step3");

        /* =========================
           STEP NAVIGATION
        ========================= */
        function showStep(step) {
            step1.style.display = "none";
            step2.style.display = "none";
            step3.style.display = "none";

            document.getElementById("step" + step).style.display = "block";
            currentStep = step;
        }

        function nextStep() {
            // STEP 1 → STEP 2
            if (currentStep === 1) {
                if (password.value !== confirm_password.value) {
                    alert("Passwords do not match");
                    return;
                }
                showStep(2);
            }
            // STEP 2 → STEP 3
            else if (currentStep === 2) {
                showStep(3);
            }
        }

        function prevStep() {
            if (currentStep === 2) showStep(1);
            else if (currentStep === 3) showStep(2);
        }

        /* =========================
           FINAL SUBMIT
        ========================= */
        async function finalSubmit() {
            try {
                // Gender
                const genderInput = document.querySelector('input[name="gender"]:checked');
                if (!genderInput) {
                    alert("Please select gender");
                    return;
                }
                const gender = genderInput.value;

                /* =========================
                   STEP 1 + STEP 3 PAYLOAD
                ========================= */
                const payload = {
                    // STEP 1 – PERSONAL DETAILS
                    name: `${fname.value} ${mname.value} ${lname.value}`,
                    email: email.value,
                    phone: phone.value,
                    dob: dob.value,
                    address: address.value,
                    gender: gender,
                    father_name: father_name.value,
                    father_phone: father_phone.value,
                    mother_name: mother_name.value,
                    mother_phone: mother_phone.value,
                    password: password.value,

                    // STEP 3 – ACADEMICS
                    academics: {
                        tenth: {
                            school: school10.value,
                            board: board10.value,
                            year: year10.value,
                            cgpa: cgpa10.value
                        },
                        twelfth: {
                            school: school12.value,
                            board: board12.value,
                            year: year12.value,
                            cgpa: cgpa12.value
                        },
                        course: course.value,
                        prn: prn.value,
                        graduation_year: grad_year.value
                    }
                };

                /* =========================
                   REGISTER USER
                ========================= */
                const registerRes = await fetch("http://127.0.0.1:5000/register", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const registerData = await registerRes.json();
                if (!registerRes.ok) {
                    alert(registerData.message || "Registration failed");
                    return;
                }

                /* =========================
                   DOCUMENT UPLOAD HELPER
                ========================= */
                async function upload(docType, inputEl) {
                    if (!inputEl || !inputEl.files || !inputEl.files.length) return;

                    const file = inputEl.files[0];

                    const fd = new FormData();
                    fd.append("email", email.value);
                    fd.append("doc_type", docType);
                    fd.append("file", file);

                    const res = await fetch("http://127.0.0.1:5000/upload-document", {
                        method: "POST",
                        body: fd
                    });

                    const data = await res.json();
                    if (!res.ok) {
                        alert(data.message || "Document upload failed");
                    }
                }

                /* =========================
                   STEP 2 DOCUMENTS
                ========================= */
                await upload("citizenship", citizenship);
                await upload("passport", passport);
                await upload("election_card", election);
                await upload("national_id", id_card);

                /* =========================
                   STEP 3 DOCUMENTS
                ========================= */
                await upload("passport_photo", passport_photo);
                await upload("marksheet_10", marksheet10);
                await upload("marksheet_12", marksheet12);
                await upload("transcript", transcript);
                await upload("migration_certificate", migratory_cert);

                alert("Registration successful!");
                window.location.href = "login.html";

            } catch (error) {
                console.error("Registration Error:", error);
                alert("Something went wrong. Please try again.");
            }
        }
    </script>




</body>

</html>